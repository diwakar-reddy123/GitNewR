import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeOptions;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.annotations.AfterClass;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;

import java.time.Duration;

public class CreateWorkOrderTest {

    WebDriver driver;
    WebDriverWait wait;

    @BeforeClass
    public void setup() {
        System.setProperty("webdriver.chrome.driver", "path/to/chromedriver");
        ChromeOptions options = new ChromeOptions();
        options.addArguments("--start-maximized");
        driver = new ChromeDriver(options);
        wait = new WebDriverWait(driver, Duration.ofSeconds(30));
    }

    @Test
    public void createWorkOrder() throws InterruptedException {
        driver.get("https://channel4dte.oneclear.net/BC/PRODUCT/Modules/Home/Home.aspx");

        // Login
        WebElement username = wait.until(ExpectedConditions.visibilityOfElementLocated(By.id("txtUserId")));
        username.sendKeys("ProgrammeManagement_test@123.com");
        WebElement password = driver.findElement(By.id("txtPassword"));
        password.sendKeys("Unified#4321");
        driver.findElement(By.id("btnLogin"))  // Assumed ID
              .click();

        // Wait for Library to load (up to 15 seconds)
        Thread.sleep(15000);

        // Click Show Navigation Panel icon
        WebElement navPanelIcon = wait.until(ExpectedConditions.elementToBeClickable(By.id("btnNavPanel"))); // Update ID if different
        navPanelIcon.click();
        Thread.sleep(7000);

        // Click Process
        WebElement processLink = wait.until(ExpectedConditions.elementToBeClickable(By.xpath("//a[text()='Process']")));
        processLink.click();
        Thread.sleep(7000);

        // Click MSP Outgest
        WebElement mspOutgest = wait.until(ExpectedConditions.elementToBeClickable(By.xpath("//a[text()='MSP Outgest']")));
        mspOutgest.click();
        Thread.sleep(7000);

        // Click Workorder
        WebElement workorder = wait.until(ExpectedConditions.elementToBeClickable(By.xpath("//a[text()='Workorder']")));
        workorder.click();
        Thread.sleep(7000);

        // Click Create
        WebElement createButton = wait.until(ExpectedConditions.elementToBeClickable(By.id("btnCreate"))); // Update if needed
        createButton.click();
        Thread.sleep(7000);

        // Fill form fields
        WebElement dueDate = wait.until(ExpectedConditions.visibilityOfElementLocated(By.id("DueDateField"))); // Update ID
        dueDate.sendKeys("Thu, 19 Jun 2025 08:27");

        WebElement woTitle = driver.findElement(By.id("TitleField")); // Update ID
        woTitle.sendKeys("PFT_TEST_AUTO_WO_1");

        WebElement variantId = driver.findElement(By.id("VariantIdField")); // Update ID
        variantId.sendKeys("59310/001_1");

        WebElement profileCode = driver.findElement(By.id("ProfileCodeField")); // Update ID
        profileCode.sendKeys("LSP_TX_AV_UAT");

        WebElement testUseOnly = driver.findElement(By.id("TestUseOnlyField")); // Update ID
        testUseOnly.sendKeys("CLEAR Edge Isilon");

        // Click Save
        WebElement saveButton = driver.findElement(By.id("btnSave")); // Update ID
        saveButton.click();

        Thread.sleep(7000); // wait after save
    }

    @AfterClass
    public void teardown() {
        if (driver != null) {
            driver.quit();
        }
    }
}